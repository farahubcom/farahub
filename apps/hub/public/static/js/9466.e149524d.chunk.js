"use strict";(globalThis.webpackChunkfarahub=globalThis.webpackChunkfarahub||[]).push([[9466],{39466:(e,i,n)=>{n.r(i),n.d(i,{default:()=>ie});var s=n(10697),t=n(4055),l=n(6007),c=n(81e3),o=n(88911),r=n(8302),a=n(17392),d=n(68903),x=n(12110),j=n(79958),h=n(26494),A=n(13365),m=n(24056),p=n(39336),v=n(688),u=n(32143),b=n(2050),g=n(26353),f=n(65043),y=n(73216),k=n(18012),S=n(30370),I=n(9877),C=n(93),w=n(20694),P=n(4398),z=n(91409),T=n(71612),D=n(83462),R=n(4219),N=n(35316),E=n(98533),B=n(29347),G=n(46987),M=n(70579);const O=({open:e,onClose:i,onDelete:n,invoice:s})=>{var t;const{enqueueSnackbar:l}=(0,G.dh)(),o=(0,k.Mv)("invoices.main"),d=(0,y.Zp)();return s?(0,M.jsxs)(D.A,{fullWidth:!0,maxWidth:"xs",open:e,onClose:i,children:[(0,M.jsxs)(R.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,M.jsx)(c.A,{children:"\u062a\u0627\u06cc\u06cc\u062f \u062d\u0630\u0641 \u0635\u0648\u0631\u062a\u200c\u062d\u0633\u0627\u0628"}),(0,M.jsx)(a.A,{onClick:i,size:"small",children:(0,M.jsx)(T.A,{})})]}),(0,M.jsx)(p.A,{}),(0,M.jsx)(N.A,{children:(0,M.jsx)(E.A,{id:"alert-dialog-description",children:["\u0622\u06cc\u0627 \u0645\u0637\u0645\u0626\u0646\u06cc\u062f \u0635\u0648\u0631\u062a\u200c\u062d\u0633\u0627\u0628",`\u0634\u0645\u0627\u0631\u0647 ${null===s||void 0===s?void 0:s.number}`,s.client&&`\u0628\u0646\u0627\u0645 ${null===(t=s.client)||void 0===t?void 0:t.fullName}`,"\u0631\u0627 \u06a9\u0646\u0633\u0644 \u0648 \u062d\u0630\u0641 \u0646\u0645\u0627\u06cc\u06cc\u062f\u061f"].filter(Boolean).join(" ")})}),(0,M.jsx)(p.A,{}),(0,M.jsxs)(B.A,{children:[(0,M.jsx)(r.A,{onClick:async()=>{const{ok:e}=await o.delete(s.id);e&&(l("\u0635\u0648\u0631\u062a\u200c\u062d\u0633\u0627\u0628 \u062d\u0630\u0641 \u06af\u0631\u062f\u06cc\u062f."),d(-1))},variant:"contained",color:"error",children:"\u062a\u0627\u06cc\u06cc\u062f \u0648 \u062d\u0630\u0641"}),(0,M.jsx)(c.A,{sx:{flexGrow:1}}),(0,M.jsx)(r.A,{onClick:i,autoFocus:!0,children:"\u0627\u0646\u0635\u0631\u0627\u0641"})]})]}):null};var $=n(34535),L=n(39652),W=n(77502),F=n(85865),Q=n(71806),Z=n(84882),q=n(28076),H=n(73460),J=n(28359),K=n(93141);const U=(0,$.Ay)(L.A)((({theme:e})=>({padding:"4px 8px",[`&.${W.A.head}`]:{color:e.palette.common,fontSize:"0.5rem",borderBottom:"0.5px solid".concat(e.palette.common.black),borderTop:"0.5px solid".concat(e.palette.common.black),borderRight:"0.5px solid".concat(e.palette.common.black),"&:first-of-type":{borderLeft:"0.5px solid".concat(e.palette.common.black)}},[`&.${W.A.body}`]:{fontSize:"0.5rem",fontWeight:500,color:e.palette.common,borderBottom:"0.5px solid".concat(e.palette.common.black),borderRight:"0.5px solid".concat(e.palette.common.black),"&:first-of-type":{borderLeft:"0.5px solid".concat(e.palette.common.black)}}}))),V=(0,f.forwardRef)((({invoice:e},i)=>{var n,s;return(0,M.jsx)(N.A,{ref:i,dir:"rtl",children:(0,M.jsxs)(c.A,{sx:{p:0},children:[(0,M.jsxs)(c.A,{sx:{mb:1},children:[(0,M.jsxs)(c.A,{sx:{display:"flex",alignItems:"flex-end",justifyContent:"space-between"},children:[(0,M.jsxs)(c.A,{children:[(0,M.jsxs)(F.A,{sx:{mb:.5,display:"block",fontSize:"0.5rem"},variant:"subtitle2",children:["\u06a9\u062f \u0645\u0634\u062a\u0631\u06cc :\u200c ",null===(n=e.client)||void 0===n?void 0:n.code]}),(0,M.jsxs)(F.A,{sx:{mb:.5,display:"block",fontSize:"0.5rem"},variant:"subtitle2",children:["\u0646\u0627\u0645 \u0645\u0634\u062a\u0631\u06cc :\u200c ",null===(s=e.client)||void 0===s?void 0:s.fullName]})]}),(0,M.jsx)(c.A,{sx:{flexGrow:1}}),(0,M.jsxs)(c.A,{children:[(0,M.jsxs)(F.A,{sx:{mb:.5,display:"block",fontSize:"0.5rem"},variant:"subtitle2",children:["\u0634\u0645\u0627\u0631\u0647 \u0641\u0627\u06a9\u062a\u0648\u0631 :\u200c ",e.number]}),(0,M.jsxs)(F.A,{sx:{mb:.5,display:"block",fontSize:"0.5rem"},variant:"subtitle2",children:["\u062a\u0627\u0631\u06cc\u062e \u0641\u0627\u06a9\u062a\u0648\u0631 :\u200c ",(0,J.A)(new Date(e.reservedAt),"yyyy/MM/dd")]}),(0,M.jsxs)(F.A,{sx:{mb:.5,display:"block",fontSize:"0.5rem"},variant:"subtitle2",children:["\u0645\u062f\u062a \u06a9\u0631\u0627\u06cc\u0647 :\u200c ",e.duration," ",(0,M.jsx)("small",{children:"\u0631\u0648\u0632"})]})]})]}),e.shippingAddress&&(0,M.jsxs)(F.A,{sx:{mb:.5,display:"block",fontSize:"0.5rem"},variant:"subtitle2",children:["\u0622\u062f\u0631\u0633 :\u200c ",e.fullShippingAddress]}),e.description&&(0,M.jsxs)(F.A,{sx:{display:"block",fontSize:"0.5rem"},variant:"subtitle2",children:["\u062a\u0648\u0636\u06cc\u062d\u0627\u062a :\u200c ",e.description,"."]})]}),(0,M.jsxs)(Q.A,{stickyHeader:!0,size:"small",children:[(0,M.jsx)(Z.A,{children:(0,M.jsxs)(q.A,{children:[(0,M.jsx)(U,{align:"center",width:40,children:"\u0631\u062f\u06cc\u0641"}),(0,M.jsx)(U,{align:"center",children:"\u06a9\u062f"}),(0,M.jsx)(U,{children:"\u0634\u0631\u062d \u0645\u062d\u0635\u0648\u0644/\u062e\u062f\u0645\u062a"}),(0,M.jsx)(U,{align:"center",children:"\u062a\u0639\u062f\u0627\u062f"}),(0,M.jsx)(U,{align:"center",children:"\u0641\u06cc"}),(0,M.jsx)(U,{align:"center",children:"\u062a\u062e\u0641\u06cc\u0641"}),(0,M.jsx)(U,{align:"center",children:"\u0645\u062c\u0645\u0648\u0639"})]})}),(0,M.jsxs)(H.A,{children:[e.items&&e.items.map(((e,i)=>{var n;return(0,M.jsxs)(q.A,{children:[(0,M.jsx)(U,{align:"center",children:i+1}),(0,M.jsx)(U,{align:"center",children:e.item.code}),(0,M.jsx)(U,{children:null===(n=e.item)||void 0===n?void 0:n.title}),(0,M.jsx)(U,{align:"center",children:e.reservedQuantity}),(0,M.jsx)(U,{align:"center",children:(0,P.A)(e.unitPrice)}),(0,M.jsx)(U,{align:"center",children:e.discountPercent}),(0,M.jsx)(U,{align:"center",children:(0,P.A)(e.total)})]},i)})),[1,2].map(((i,n)=>(0,M.jsxs)(q.A,{children:[(0,M.jsx)(U,{sx:{px:0},align:"center",children:(e.items||[]).length+n+1}),(0,M.jsx)(U,{sx:{px:1},align:"center"}),(0,M.jsx)(U,{}),(0,M.jsx)(U,{align:"center"}),(0,M.jsx)(U,{align:"center"}),(0,M.jsx)(U,{align:"center"}),(0,M.jsx)(U,{align:"center"})]},n))),(0,M.jsxs)(q.A,{children:[(0,M.jsx)(L.A,{sx:{borderRight:"1px solid #000",borderBlockColor:"transparent"},colSpan:4}),(0,M.jsx)(U,{colSpan:2,children:"\u062c\u0645\u0639 \u06a9\u0644 \u0641\u0627\u06a9\u062a\u0648\u0631"}),(0,M.jsx)(U,{align:"center",children:(0,P.A)(e.subtotal)})]}),e.factors&&e.factors.map(((e,i)=>(0,M.jsxs)(q.A,{children:[(0,M.jsx)(L.A,{sx:{borderRight:"1px solid #000",borderBlockColor:"transparent"},colSpan:4}),(0,M.jsx)(U,{colSpan:2,children:e.title}),(0,M.jsx)(U,{align:"center",children:(0,P.A)(e.amount)})]},i))),(0,M.jsxs)(q.A,{children:[(0,M.jsx)(L.A,{sx:{borderRight:"1px solid #000",borderBlockColor:"transparent"},colSpan:4}),(0,M.jsx)(U,{colSpan:2,children:"\u062e\u0627\u0644\u0635 \u0641\u0627\u06a9\u062a\u0648\u0631"}),(0,M.jsxs)(U,{align:"center",children:[(0,M.jsx)("strong",{children:(0,P.A)(e.total)})," ",(0,M.jsx)("small",{children:"\u0631\u06cc\u0627\u0644"})]})]})]})]}),(0,M.jsxs)(c.A,{sx:{py:3,display:"flex"},children:[(0,M.jsx)(c.A,{component:F.A,sx:{flexGrow:1,textAlign:"center",fontSize:"0.5rem"},variant:"subtitle2",children:"\u0627\u0645\u0636\u0627\u0621 \u0641\u0631\u0648\u0634\u0646\u062f\u0647"}),(0,M.jsx)(c.A,{component:F.A,sx:{flexGrow:1,textAlign:"center",fontSize:"0.5rem"},variant:"subtitle2",children:"\u0627\u0645\u0636\u0627\u0621 \u062e\u0631\u06cc\u062f\u0627\u0631"})]}),(0,M.jsxs)(c.A,{children:[(0,M.jsx)(F.A,{sx:{display:"block",mb:1,fontSize:"0.675rem"},variant:"subtitle2",children:"\u0634\u0631\u0627\u06cc\u0637 \u062a\u0639\u06cc\u06cc\u0646 \u0634\u062f\u0647 \u0628\u0631\u0627\u06cc \u0627\u062c\u0627\u0631\u0647 \u0648\u0633\u0627\u06cc\u0644 :"}),(0,M.jsx)(F.A,{sx:{display:"block",textAlign:"justify",fontSize:"0.5rem"},variant:"body2",children:"\u06f1. \u0645\u0634\u062a\u0631\u06cc \u0645\u0648\u0638\u0641 \u0627\u0633\u062a \u0636\u0645\u0646 \u062a\u062d\u0648\u06cc\u0644 \u06a9\u0627\u0631\u062a \u0634\u0646\u0627\u0633\u0627\u06cc\u06cc \u0645\u0648\u062c\u0647 \u0648 \u0645\u0639\u062a\u0628\u0631 \u0648 \u067e\u0631\u062f\u0627\u062e\u062a \u06a9\u0627\u0645\u0644 \u0647\u0632\u06cc\u0646\u0647 \u0642\u0628\u0644 \u0627\u0632 \u0627\u062c\u0627\u0631\u0647 \u0644\u0648\u0627\u0632\u0645\u060c \u062f\u0631 \u0647\u0631 \u0633\u0627\u0639\u062a\u06cc \u0627\u0632 \u0634\u0628\u0627\u0646\u0647\u200c\u0631\u0648\u0632 \u06a9\u0647 \u0648\u0633\u0627\u06cc\u0644  \u0627\u062c\u0627\u0631\u0647\u200c\u0627\u06cc \u062e\u0648\u062f \u0631\u0627 \u062a\u062d\u0648\u06cc\u0644 \u0645\u06cc\u200c\u06af\u06cc\u0631\u062f \u0645\u062a\u0639\u0647\u062f \u0634\u0648\u062f \u0648\u0633\u0627\u06cc\u0644 \u0645\u0648\u0631\u062f \u0627\u062c\u0627\u0631\u0647 \u0631\u0627 \u062a\u0627 \u0633\u0627\u0639\u062a \u06f1\u06f0 \u0635\u0628\u062d \u0631\u0648\u0632 \u0628\u0639\u062f\u060c \u062a\u062d\u0648\u06cc\u0644 \u0638\u0631\u0648\u0641 \u06a9\u0631\u0627\u06cc\u0647 \u0646\u0645\u0627\u06cc\u062f \u062f\u0631 \u063a\u06cc\u0631\u0627\u06cc\u0646\u0635\u0648\u0631\u062a \u062c\u0647\u062a \u062c\u0628\u0631\u0627\u0646 \u062e\u0633\u0627\u0631\u062a \u062a\u0627\u062e\u06cc\u0631\u060c \u06a9\u0631\u0627\u06cc\u0647 \u0645\u062c\u062f\u062f \u0645\u062d\u0627\u0633\u0628\u0647 \u0645\u06cc\u200c\u06af\u0631\u062f\u062f."}),(0,M.jsx)(F.A,{sx:{mb:1,display:"block",textAlign:"justify",fontSize:"0.5rem"},variant:"body2",children:"\u06f2. \u0645\u0634\u062a\u0631\u06cc \u0645\u0648\u0638\u0641 \u0627\u0633\u062a \u062f\u0631 \u0635\u0648\u0631\u062a \u06a9\u0646\u0633\u0644\u06cc \u0644\u0648\u0627\u0632\u0645 \u0645\u0648\u0631\u062f \u0627\u062c\u0627\u0631\u0647\u060c \u062a\u0627 \u06f7\u06f2 \u0633\u0627\u0639\u062a \u0642\u0628\u0644 \u0627\u0632 \u0632\u0645\u0627\u0646 \u062a\u062d\u0648\u06cc\u0644 \u0627\u0639\u0644\u0627\u0646 \u0646\u0645\u0627\u06cc\u062f \u062f\u0631 \u063a\u06cc\u0631 \u0627\u06cc\u0646\u0635\u0648\u0631\u062a \u0645\u0648\u0638\u0641 \u0628\u0647 \u067e\u0631\u062f\u0627\u062e\u062a \u06f3\u06f0 \u062a\u0627 \u06f6\u06f0 \u062f\u0631\u0635\u062f \u0648 \u062f\u0631\u0635\u0648\u0631\u062a \u06a9\u0646\u0633\u0644\u06cc \u0628\u0639\u062f \u0627\u0632 \u06f2\u06f4 \u0633\u0627\u0639\u062a \u0645\u0627\u0646\u062f\u0647 \u0628\u0647 \u0632\u0645\u0627\u0646 \u062a\u062d\u0648\u06cc\u0644 \u0645\u0648\u0638\u0641 \u0628\u0647 \u067e\u0631\u062f\u0627\u062e\u062a \u06f1\u06f0\u06f0 \u062f\u0631\u0635\u062f \u0627\u0632 \u0647\u0632\u06cc\u0646\u0647 \u0627\u062c\u0627\u0631\u0647 \u0644\u0648\u0627\u0632\u0645 \u0645\u0648\u0631\u062f \u0627\u062c\u0627\u0631\u0647 \u0645\u06cc\u200c\u06af\u0631\u062f\u062f."})]})]})})})),X=({open:e,onClose:i,invoice:n})=>{const s=(0,f.useRef)(),t=(0,K.useReactToPrint)({content:()=>s.current}),l=e=>{e.ctrlKey&&80==e.keyCode&&t()};return(0,f.useEffect)((()=>(window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)})),[]),(0,M.jsxs)(D.A,{open:e,onClose:i,fullWidth:!0,maxWidth:"md",children:[(0,M.jsxs)(R.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,M.jsx)(c.A,{children:"\u0635\u0648\u0631\u062a\u062d\u0633\u0627\u0628 \u0686\u0627\u067e\u06cc"}),(0,M.jsx)(a.A,{onClick:i,size:"small",children:(0,M.jsx)(T.A,{})})]}),(0,M.jsx)(p.A,{}),(0,M.jsx)(V,{invoice:n||{},ref:s}),(0,M.jsx)(p.A,{}),(0,M.jsxs)(B.A,{children:[(0,M.jsx)(r.A,{variant:"contained",onClick:t,children:"\u0686\u0627\u067e"}),(0,M.jsx)(c.A,{sx:{flexGrow:1}}),(0,M.jsx)(r.A,{onClick:i,children:"\u0628\u0633\u062a\u0646"})]})]})};var Y=n(49030),_=n.n(Y),ee=n(84162);const ie=()=>{var e,i;const n=(0,y.Zp)(),T=(0,y.zy)(),D=(0,y.g)(),{inject:R}=(0,S.As)(),N=(0,k.Mv)("invoices.main"),[E,B]=(0,f.useState)(!1),[G,$]=(0,f.useState)({}),[L,W]=(0,f.useState)(null),F=async()=>{B(!0);const e=await N.details(D.invoiceId);e.ok&&($(e.invoice),B(!1))};(0,f.useEffect)((()=>{F()}),[D.invoiceId]);const{isOpen:Q,isOpening:Z,open:q,close:H,data:J}=(0,z.A)(),{isOpen:K,isOpening:U,open:V,close:Y,data:ie}=(0,z.A)(),ne=R("invoices","InvoiceDetails.State"),[se,te]=(0,f.useState)(ne?Object.assign({},...ne):{}),le=(0,f.useMemo)((()=>G&&G.items?ee.A.getInvoiceTotal(G.items,G.factors):0),[G]),ce=(0,k.b7)("Invoices.details");return(0,M.jsx)(w.JQ,{loading:E,...Object.assign({},ce(G),...R("Invoices","InvoiceDetails.TabView",{loading:E,invoice:G})||[]),children:(0,M.jsxs)(c.A,{sx:{p:{xs:1,sm:2,md:3}},children:[(0,M.jsxs)(c.A,{sx:{display:"flex",mb:1},children:[(0,M.jsx)(c.A,{sx:{flexGrow:1}}),(0,M.jsx)(c.A,{className:"invoice-actions",children:(0,M.jsxs)(o.A,{direction:"row",spacing:.5,children:[(0,M.jsx)(r.A,{variant:"transparent",startIcon:(0,M.jsx)(l.A,{}),onClick:()=>q(G),disabled:Z,children:"\u0686\u0627\u067e"}),(0,M.jsx)(a.A,{onClick:e=>W(e.currentTarget),children:(0,M.jsx)(t.A,{})})]})})]}),(0,M.jsxs)(d.Ay,{container:!0,spacing:2,alignItems:"flex-start",children:[(0,M.jsxs)(d.Ay,{item:!0,xs:12,md:3,container:!0,spacing:2,children:[(0,M.jsx)(d.Ay,{item:!0,xs:12,children:(0,M.jsxs)(x.A,{variant:"outlined",className:"invoice-general",children:[(0,M.jsx)(j.A,{title:"\u0635\u0648\u0631\u062a\u200c\u062d\u0633\u0627\u0628",titleTypographyProps:{variant:"h6"}}),(0,M.jsx)(h.A,{children:(0,M.jsx)(I.A,{data:[{title:"\u0634\u0645\u0627\u0631\u0647",description:G.number},{title:"\u062a\u0627\u0631\u06cc\u062e \u062b\u0628\u062a",description:(0,M.jsx)(C.A,{date:G.issuedAt})},{title:"\u062e\u0627\u0644\u0635 \u0641\u0627\u06a9\u062a\u0648\u0631",description:(0,M.jsxs)(c.A,{children:[_()(le)?(0,P.A)(le):0," ",(0,M.jsx)("small",{children:"\u0631\u06cc\u0627\u0644"})]})},{title:"\u062a\u0648\u0636\u06cc\u062d\u0627\u062a",description:G.note}]})})]})}),R("invoices","InvoiceDetails.PreSide",{invoice:G,state:se,setState:te,refetch:F})]}),(0,M.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,M.jsxs)(x.A,{variant:"outlined",children:[(0,M.jsxs)(A.A,{value:T.pathname,children:[(0,M.jsx)(m.A,{className:"invoice-bill",value:`/invoice/${D.invoiceId}`,onClick:()=>n(`/invoice/${D.invoiceId}`,{state:{prev:T},replace:!0}),label:"\u0641\u0627\u06a9\u062a\u0648\u0631"}),(R("invoices","InvoiceDetails.TabsList",{invoiceId:D.invoiceId})||[]).map(((e,i)=>(0,M.jsx)(m.A,{value:e.value,onClick:()=>n(e.value,{state:{prev:T},replace:!0}),label:e.label,className:e.className},i)))]}),(0,M.jsx)(p.A,{}),(0,M.jsx)(y.sv,{})]})}),(0,M.jsxs)(d.Ay,{item:!0,xs:12,md:3,container:!0,spacing:2,children:[(0,M.jsx)(d.Ay,{item:!0,xs:12,children:(0,M.jsxs)(x.A,{variant:"outlined",className:"invoice-customer",children:[(0,M.jsx)(j.A,{title:"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0645\u0634\u062a\u0631\u06cc",titleTypographyProps:{variant:"h6"}}),(0,M.jsx)(h.A,{children:(0,M.jsx)(I.A,{data:[{title:"\u0645\u0634\u062a\u0631\u06cc",description:null===(e=G.customer)||void 0===e?void 0:e.fullName},{title:"\u0634\u0645\u0627\u0631\u0647\u200c\u0647\u0627\u06cc \u062a\u0645\u0627\u0633",description:null===(i=G.customer)||void 0===i?void 0:i.fullContact}]})})]})}),R("invoices","InvoiceDetails.PostSide",{invoice:G,state:se,setState:te,refetch:F})]})]}),(0,M.jsx)(X,{open:Q,onClose:H,invoice:J}),(0,M.jsx)(O,{open:K,onClose:Y,invoice:ie}),R("invoices","InvoiceDetails.PostFooter",{invoice:G,state:se,setState:te,refetch:F}),(0,M.jsxs)(v.A,{open:Boolean(L),anchorEl:L,onClose:()=>W(null),children:[R("invoices","InvoiceDetails.Menu",{invoice:G,refetch:F,menuProps:{setAnchor:W}}),(0,M.jsxs)(u.A,{onClick:()=>{W(null),V(G)},children:[(0,M.jsx)(b.A,{children:(0,M.jsx)(s.A,{})}),(0,M.jsx)(g.A,{children:"\u062d\u0630\u0641"})]})]})]})})}},84162:(e,i,n)=>{n.d(i,{A:()=>o});var s,t=n(42907),l=n.n(t);class c{}s=c,c.getItemPureTotal=e=>e.amount*e.unitPrice,c.getItemDiscountPrice=e=>e.discount||0,c.getItemTotalPrice=e=>s.getItemPureTotal(e)-s.getItemDiscountPrice(e),c.getFactorPrice=(e,i)=>("PRICE"===i.unit?i.amount:i.amount/100*s.getInvoiceSubtotal(e))*("REDUCER"===i.type?-1:1),c.getInvoiceSubtotal=e=>l()(e,(e=>s.getItemTotalPrice(e))),c.getInvoiceTotal=(e,i)=>Number(s.getInvoiceSubtotal(e))+l()(i,(i=>s.getFactorPrice(e,i)));const o=c}}]);
//# sourceMappingURL=9466.e149524d.chunk.js.map