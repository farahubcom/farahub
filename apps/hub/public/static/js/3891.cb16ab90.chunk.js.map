{"version":3,"file":"static/js/3891.cb16ab90.chunk.js","mappings":"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","sources":["modules/invoices/Utils.js","modules/invoices/pages/InvoiceDetails/InvoiceTable.js","../node_modules/lodash/_baseSum.js","../node_modules/lodash/isFinite.js","../node_modules/lodash/sumBy.js"],"sourcesContent":["import sumBy from \"lodash/sumBy\";\r\n\r\nclass Utils {\r\n    static getItemPureTotal = (item) => item.amount * item.unitPrice;\r\n    static getItemDiscountPrice = (item) => item.discount || 0;\r\n    static getItemTotalPrice = (item) => this.getItemPureTotal(item) - this.getItemDiscountPrice(item);\r\n    // static getItemTotalPrice = (item) => this.getItemPureTotal(item) - (item.discount || 0);\r\n\r\n    static getFactorPrice = (items, factor) => {\r\n        return (\r\n            factor.unit === 'PRICE' ?\r\n                factor.amount :\r\n                (factor.amount / 100 * this.getInvoiceSubtotal(items))\r\n        ) * (factor.type === 'REDUCER' ? -1 : 1);\r\n    }\r\n\r\n    static getInvoiceSubtotal = (items) => sumBy(items, (itm) => this.getItemTotalPrice(itm));\r\n    static getInvoiceTotal = (items, factors) => Number(this.getInvoiceSubtotal(items)) +\r\n        sumBy(factors, factor => this.getFactorPrice(items, factor));\r\n}\r\n\r\nexport default Utils","import {\r\n    Box, styled, Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow, Typography\r\n} from \"@mui/material\";\r\nimport isFinite from \"lodash/isFinite\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { useParams } from \"react-router\";\r\nimport { useMiddleware } from \"../../../../Application\";\r\nimport { useAuth } from \"../../../../auth\";\r\nimport TableLoader from \"../../../../components/TableLoader\";\r\nimport pricify from \"../../../../utils/pricify\";\r\nimport Utils from \"../../Utils\";\r\n\r\n\r\nconst StyledTableRow = styled(TableRow)(({ theme }) => ({\r\n    '&:nth-of-type(odd)': {\r\n        backgroundColor: theme.palette.action.hover\r\n    },\r\n    '&:last-child td, &:last-child th': {\r\n        border: 0,\r\n    },\r\n}));\r\n\r\n\r\nconst InvoiceTable = () => {\r\n\r\n    const { inject } = useAuth();\r\n    const middleware = useMiddleware('invoices.main');\r\n\r\n    const params = useParams();\r\n\r\n    const [isLoading, setLoading] = useState(true);\r\n    const [invoice, setInvoice] = useState();\r\n\r\n    const _loadDetailsAsync = async () => {\r\n        setLoading(true);\r\n        const response = await middleware.details(params.invoiceId);\r\n        if (response.ok) {\r\n            setInvoice(response.invoice);\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        _loadDetailsAsync();\r\n    }, [params.invoiceId]);\r\n\r\n\r\n    const total = useMemo(() => invoice && invoice.items ? Utils.getInvoiceTotal(invoice.items, invoice.factors) : 0, [invoice])\r\n\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <TableLoader size=\"small\" />\r\n        )\r\n    }\r\n\r\n    return (\r\n        <TableContainer>\r\n            <Table size=\"small\" stickyHeader>\r\n                <TableHead>\r\n                    <TableRow>\r\n                        <TableCell align=\"center\">#</TableCell>\r\n                        <TableCell align=\"center\">کد</TableCell>\r\n                        <TableCell>شرح</TableCell>\r\n                        {inject('invoices', 'InvoiceItemsTable.HeadCells.AfterTitle')}\r\n                        <TableCell align=\"center\">تعداد</TableCell>\r\n                        <TableCell align=\"center\">فی <small>(ریال)</small></TableCell>\r\n                        <TableCell align=\"center\">تخفیف</TableCell>\r\n                        <TableCell align=\"center\">مجموع</TableCell>\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {invoice.items.map((item, idx) => (\r\n                        <StyledTableRow key={item.id}>\r\n                            <TableCell align=\"center\">{idx + 1}</TableCell>\r\n                            <TableCell align=\"center\">{item.item.code}</TableCell>\r\n                            <TableCell>{item.item.name}</TableCell>\r\n                            {inject('invoices', 'InvoiceItemsTable.BodyCells.AfterTitle', { item })}\r\n                            <TableCell align=\"center\">{item.amount}</TableCell>\r\n                            <TableCell align=\"center\">{pricify(item.unitPrice)}</TableCell>\r\n                            <TableCell align=\"center\">{pricify(Utils.getItemDiscountPrice(item))}</TableCell>\r\n                            <TableCell align=\"center\">{pricify(Utils.getItemTotalPrice(item))}</TableCell>\r\n                        </StyledTableRow>\r\n                    ))}\r\n                    <StyledTableRow>\r\n                        <TableCell colSpan={100}>\r\n                            <Box sx={{ width: '33.33%', ml: 'auto', display: 'flex' }}>\r\n                                <Typography variant=\"subtitle2\">جمع کل فاکتور</Typography>\r\n                                <Box sx={{ flexGrow: 1 }} />\r\n                                <Typography variant=\"subtitle2\" sx={{ px: '16px' }}>{pricify(invoice.subtotal)}</Typography>\r\n                            </Box>\r\n                        </TableCell>\r\n                    </StyledTableRow>\r\n                    {invoice && invoice.factors?.map((factor, index) => (\r\n                        <StyledTableRow key={factor.id}>\r\n                            <TableCell colSpan={100}>\r\n                                <Box sx={{ width: '33.33%', ml: 'auto', display: 'flex' }}>\r\n                                    <Typography variant=\"subtitle2\">{factor.title} {factor.unit === 'PERCENT' ? `(${factor.amount}%)` : ''}</Typography>\r\n                                    <Box sx={{ flexGrow: 1 }} />\r\n                                    <Typography variant=\"subtitle2\" sx={{ px: '16px' }}>{pricify(factor.amount)}</Typography>\r\n                                </Box>\r\n                            </TableCell>\r\n                        </StyledTableRow>\r\n                    ))}\r\n                    <StyledTableRow>\r\n                        <TableCell colSpan={100}>\r\n                            <Box sx={{ width: '33.33%', ml: 'auto', display: 'flex' }}>\r\n                                <Typography variant=\"subtitle2\">خالص فاکتور</Typography>\r\n                                <Box sx={{ flexGrow: 1 }} />\r\n                                <Typography variant=\"subtitle2\" sx={{ px: '16px' }}><strong>{isFinite(total) ? pricify(total) : 0}</strong> <small>ریال</small></Typography>\r\n                            </Box>\r\n                        </TableCell>\r\n                    </StyledTableRow>\r\n                </TableBody>\r\n            </Table>\r\n        </TableContainer>\r\n    )\r\n}\r\n\r\nexport default InvoiceTable","/**\n * The base implementation of `_.sum` and `_.sumBy` without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {number} Returns the sum.\n */\nfunction baseSum(array, iteratee) {\n  var result,\n      index = -1,\n      length = array.length;\n\n  while (++index < length) {\n    var current = iteratee(array[index]);\n    if (current !== undefined) {\n      result = result === undefined ? current : (result + current);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseSum;\n","var root = require('./_root');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsFinite = root.isFinite;\n\n/**\n * Checks if `value` is a finite primitive number.\n *\n * **Note:** This method is based on\n * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n * @example\n *\n * _.isFinite(3);\n * // => true\n *\n * _.isFinite(Number.MIN_VALUE);\n * // => true\n *\n * _.isFinite(Infinity);\n * // => false\n *\n * _.isFinite('3');\n * // => false\n */\nfunction isFinite(value) {\n  return typeof value == 'number' && nativeIsFinite(value);\n}\n\nmodule.exports = isFinite;\n","var baseIteratee = require('./_baseIteratee'),\n    baseSum = require('./_baseSum');\n\n/**\n * This method is like `_.sum` except that it accepts `iteratee` which is\n * invoked for each element in `array` to generate the value to be summed.\n * The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Math\n * @param {Array} array The array to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {number} Returns the sum.\n * @example\n *\n * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n *\n * _.sumBy(objects, function(o) { return o.n; });\n * // => 20\n *\n * // The `_.property` iteratee shorthand.\n * _.sumBy(objects, 'n');\n * // => 20\n */\nfunction sumBy(array, iteratee) {\n  return (array && array.length)\n    ? baseSum(array, baseIteratee(iteratee, 2))\n    : 0;\n}\n\nmodule.exports = sumBy;\n"],"names":["Utils","getItemPureTotal","item","amount","unitPrice","getItemDiscountPrice","discount","getItemTotalPrice","getFactorPrice","items","factor","unit","getInvoiceSubtotal","type","sumBy","itm","getInvoiceTotal","factors","Number","StyledTableRow","styled","TableRow","theme","backgroundColor","palette","action","hover","border","InvoiceTable","_invoice$factors","inject","useAuth","middleware","useMiddleware","params","useParams","isLoading","setLoading","useState","invoice","setInvoice","useEffect","async","response","details","invoiceId","ok","_loadDetailsAsync","total","useMemo","_jsx","TableLoader","size","TableContainer","children","_jsxs","Table","stickyHeader","TableHead","TableCell","align","TableBody","map","idx","code","name","pricify","id","colSpan","Box","sx","width","ml","display","Typography","variant","flexGrow","px","subtotal","index","title","isFinite","module","exports","array","iteratee","result","length","current","undefined","nativeIsFinite","require","value","baseIteratee","baseSum"],"sourceRoot":""}