"use strict";(globalThis.webpackChunkfarahub=globalThis.webpackChunkfarahub||[]).push([[5912],{24010:(e,o,t)=>{t.d(o,{A:()=>C});var r=t(98587),n=t(58168),i=t(65043),a=t(58387),s=t(65049),l=t(75429),c=t(9848),d=t(98206),h=t(14987),p=t(60239);function u(e){return(0,p.Ay)("MuiFab",e)}const m=(0,h.A)("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]);var g=t(34535),b=t(61475),x=t(70579);const A=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],v=(0,g.Ay)(l.A,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>(0,b.A)(e)||"classes"===e,overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.root,o[t.variant],o[`size${(0,c.A)(t.size)}`],"inherit"===t.color&&o.colorInherit,o[(0,c.A)(t.size)],o[t.color]]}})((({theme:e,ownerState:o})=>{var t,r;return(0,n.A)({},e.typography.button,{minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:null==(t=(r=e.palette).getContrastText)?void 0:t.call(r,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${m.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]}},"small"===o.size&&{width:40,height:40},"medium"===o.size&&{width:48,height:48},"extended"===o.variant&&{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},"extended"===o.variant&&"small"===o.size&&{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"extended"===o.variant&&"medium"===o.size&&{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40},"inherit"===o.color&&{color:"inherit"})}),(({theme:e,ownerState:o})=>(0,n.A)({},"inherit"!==o.color&&"default"!==o.color&&null!=(e.vars||e).palette[o.color]&&{color:(e.vars||e).palette[o.color].contrastText,backgroundColor:(e.vars||e).palette[o.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[o.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[o.color].main}}})),(({theme:e})=>({[`&.${m.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}))),C=i.forwardRef((function(e,o){const t=(0,d.b)({props:e,name:"MuiFab"}),{children:i,className:l,color:h="default",component:p="button",disabled:m=!1,disableFocusRipple:g=!1,focusVisibleClassName:b,size:C="large",variant:f="circular"}=t,j=(0,r.A)(t,A),w=(0,n.A)({},t,{color:h,component:p,disabled:m,disableFocusRipple:g,size:C,variant:f}),y=(e=>{const{color:o,variant:t,classes:r,size:i}=e,a={root:["root",t,`size${(0,c.A)(i)}`,"inherit"===o?"colorInherit":o]},l=(0,s.A)(a,u,r);return(0,n.A)({},r,l)})(w);return(0,x.jsx)(v,(0,n.A)({className:(0,a.A)(y.root,l),component:p,disabled:m,focusRipple:!g,focusVisibleClassName:(0,a.A)(y.focusVisible,b),ownerState:w,ref:o},j,{classes:y,children:i}))}))},44413:(e,o,t)=>{var r=t(24994);o.A=void 0;var n=r(t(40039)),i=t(70579);o.A=(0,n.default)((0,i.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"MenuOutlined")},48478:(e,o,t)=>{t.d(o,{A:()=>n});var r=t(73216);const n=()=>{const e=(0,r.Zp)(),o=(0,r.zy)();return(t,r={})=>e(t,{state:r.replace?o.state:{prev:o},...r})}},65912:(e,o,t)=>{t.r(o),t.d(o,{default:()=>N});var r=t(22505),n=t(44413),i=t(81e3),a=t(88911),s=t(12110),l=t(20819),c=t.n(l),d=t(87424),h=t.n(d),p=t(35475),u=t(18012),m=t(30370),g=t(97324),b=t(56976),x=t(20694),A=t(74175),v=t(5748),C=t(43845),f=t(38968),j=t(26353),w=t(65043),y=t(66789),k=t(12766),P=t(32665),z=t(27800),S=t(55542),R=t(29572);var I=t(70579);const F=({loading:e,data:o,meta:t,infiniteScrollProps:r,onClickRun:n,onClickDelete:a})=>{const{inject:s}=(0,m.As)(),[l,d]=(0,p.ok)(),[u,g]=(0,w.useState)(l.has("sort")?l.get("sort"):"-createdAt");(0,P.A)((()=>{d({...Object.fromEntries(l),sort:u})}),[u]);const b=(0,z.A)();return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(y.A,{data:o,loading:e,infiniteScrollProps:r,definitions:h()([{title:"\u0631\u062f\u06cc\u0641",headerCellProps:{align:"center"},rowCellProps:{align:"center",width:100},renderCell:(e,o)=>(0,I.jsx)(k.A,{children:b(o)}),priority:100},{field:"content",title:"\u0645\u062a\u0646 \u067e\u06cc\u0627\u0645",rowCellProps:{width:200},render:e=>{var o;return(0,I.jsx)(i.A,{whiteSpace:"pre-line",children:(0,I.jsx)(k.A,{children:null===(o=e.message)||void 0===o?void 0:o.content})})||"-"},priority:200},{title:"\u06af\u0631\u0648\u0647\u200c\u0647\u0627\u06cc \u0647\u062f\u0641",rowCellProps:{width:300},renderCell:e=>(0,I.jsx)(k.A,{children:e.targets.map((e=>e.target.name)).join(", ")}),priority:300},{title:"\u0648\u0636\u0639\u06cc\u062a \u067e\u06cc\u0627\u0645",rowCellProps:{width:50},renderCell:e=>(()=>{let o={};switch(e.message.latestStatus.status){case"pending":o={label:"\u062f\u0631 \u062d\u0627\u0644 \u062a\u0627\u06cc\u06cc\u062f",color:"warning"};break;case"confirmed":o={label:"\u062a\u0627\u06cc\u06cc\u062f \u0634\u062f\u0647",color:"success"};break;case"rejected":o={label:"\u0631\u062f \u0634\u062f\u0647",color:"error"};break;default:o={label:"\u0646\u0627\u0645\u0634\u062e\u0635",color:"default"}}return(0,I.jsx)(C.A,{...o,size:"small"})})(),priority:300},{title:"\u0648\u0636\u0639\u06cc\u062a \u0627\u0631\u0633\u0627\u0644",headerCellProps:{align:"center",sx:{whiteSpace:"nowrap"}},rowCellProps:{width:100},renderCell:e=>(()=>{let o={};return"confirmed"!==e.message.latestStatus.status?null:(e.shouldRunAt||(o={label:"\u0622\u0645\u0627\u062f\u0647 \u0627\u0631\u0633\u0627\u0644",color:"info"}),e.shouldRunAt&&(o=function(e){return(0,R.A)(1,arguments),(0,S.A)(e).getTime()>Date.now()}(new Date(e.shouldRunAt))?{label:"\u062f\u0631 \u062d\u0627\u0644 \u0627\u0631\u0633\u0627\u0644",color:"info"}:{label:"\u0627\u0631\u0633\u0627\u0644 \u0634\u062f\u0647",color:"success"}),(0,I.jsx)(C.A,{...o,size:"small"}))})(),priority:300},...c()(s("Customers-Club","CampaignsList.definitions")||[])],(e=>e.priority)),renderSheetTitle:e=>{var o;return(0,I.jsx)(i.A,{whiteSpace:"pre-line",children:(0,I.jsx)(k.A,{children:null===(o=e.message)||void 0===o?void 0:o.content})})},renderListItemChildren:e=>{var o;return(0,I.jsx)(f.A,{children:(0,I.jsx)(j.A,{primary:(0,I.jsx)(i.A,{whiteSpace:"pre-line",children:(0,I.jsx)(k.A,{children:null===(o=e.message)||void 0===o?void 0:o.content})})})})},tableRowProps:e=>({striped:!0}),paginationProps:{count:t.total,rowsPerPage:l.get("perPage")||25,page:l.get("page")||0,onPageChange:(e,o)=>d({...Object.fromEntries([...l]),page:o}),onRowsPerPageChange:e=>d({...Object.fromEntries([...l]),perPage:e.target.value})},actions:[e=>"confirmed"===e.message.latestStatus.status?{title:"\u0627\u0631\u0633\u0627\u0644",variant:"button",icon:(0,I.jsx)(v.In,{icon:"solar:map-arrow-left-bold"}),onClick:n,authorize:({hasRole:e,hasPermission:o})=>e("owner")||o("campaign:run")}:void 0,{title:"\u062d\u0630\u0641",icon:(0,I.jsx)(v.In,{icon:"solar:trash-bin-minimalistic-2-bold"}),onClick:a,authorize:({hasRole:e,hasPermission:o})=>e("owner")||o("campaign:delete"),componentProps:{color:"error"}}]})})};var D=t(46987),M=t(48478),E=t(11107),O=t(22070),T=t(51833);const L=({open:e,onClose:o,campaign:t,onDelete:r,requestConfig:n,...i})=>{const a=(0,u.Mv)("Customers-Club.Campaigns"),[s,l]=(0,w.useState)(!1);(0,w.useEffect)((()=>{e&&l(!1)}),[e]);return(0,I.jsx)(T.A,{open:e,onClose:o,...i,title:"\u0627\u0631\u0633\u0627\u0644 \u06af\u0631\u0648\u0647\u06cc \u062d\u0630\u0641 \u06af\u0631\u062f\u062f\u061f",content:"\u0627\u0631\u0633\u0627\u0644 \u06af\u0631\u0648\u0647\u06cc \u0628\u0631\u0627\u06cc \u0647\u0645\u06cc\u0634\u0647 \u062d\u0630\u0641 \u06af\u0631\u062f\u062f\u061f",onConfirm:async()=>{l(!0);try{const e=await a.delete(null===t||void 0===t?void 0:t.id,n);l(!1),e.ok&&r()}catch(e){console.log(e)}},confirmButtonProps:{color:"error"},cancelButtonProps:{autoFocus:!0},confirmText:"\u062d\u0630\u0641 \u0628\u0631\u0627\u06cc \u0647\u0645\u06cc\u0634\u0647",loading:s,confirmIcon:(0,I.jsx)(O.A,{})})},N=()=>{const{inject:e}=(0,m.As)(),o=(0,u.Mv)("Customers-Club.Campaigns"),[t]=(0,p.ok)(),l=(0,M.A)(),{data:d,total:v,loading:C,loadMore:f,reload:j}=(0,A.A)({handleFetch:e=>o.list({...e,...Object.fromEntries([...t])}),loadDeps:[t],infiniteScrollDefaultParams:{page:t.has("page")?t.get("page"):0,perPage:t.has("perPage")?t.get("perPage"):25}});(0,w.useEffect)((()=>{!C&&v<1&&l("add")}),[d,v,C]);const{enqueueSnackbar:y}=(0,D.dh)(),[k,P,z]=(0,E.A)("delete",{hashDeps:["person"]}),S=Object.assign({},...e("Customers-Club","CampaignsList.Hooks")||[]),R=(0,u.b7)("Customers-Club.campaigns");return(0,I.jsx)(x.JQ,{...R,children:(0,I.jsxs)(b.A,{children:[(0,I.jsxs)(i.A,{sx:{display:"flex",mb:{xs:0,sm:1}},children:[(0,I.jsx)(i.A,{sx:{flexGrow:1}}),(0,I.jsx)(a.A,{direction:"row",spacing:1,children:(0,I.jsx)(g.A,{actions:h()([{title:"\u0627\u0631\u0633\u0627\u0644 \u06af\u0631\u0648\u0647\u06cc \u062c\u062f\u06cc\u062f",icon:(0,I.jsx)(r.A,{}),onClick:()=>l("add"),authorize:({hasRole:e,hasPermission:o})=>e("owner")||o("person:edit"),priority:100},...c()(e("Customers-Club","CampaignsList.ActionsList",{data:d,loading:C,reload:j,...S})||[])],(e=>e.priority)),ResponsiveActionIcon:(0,I.jsx)(n.A,{}),responsiveActionProps:{color:"primary"}})})]}),(0,I.jsx)(s.A,{variant:"outlined",sx:{flexGrow:1},children:(0,I.jsx)(F,{data:d,loading:C,meta:{total:v},infiniteScrollProps:{loading:!1,hasNextPage:d.length<v,onLoadMore:f},onClickRun:async e=>{try{(await o.run(null===e||void 0===e?void 0:e.id)).ok&&(y("\u0627\u0631\u0633\u0627\u0644 \u06af\u0631\u0648\u0647\u06cc \u0627\u062c\u0631\u0627 \u06af\u0631\u062f\u06cc\u062f"),j())}catch(t){console.log(t)}},onClickDelete:e=>{P({campaign:e})}})}),(0,I.jsx)(L,{...k,onDelete:()=>{y("\u0627\u0631\u0633\u0627\u0644 \u06af\u0631\u0648\u0647\u06cc \u062d\u0630\u0641 \u06af\u0631\u062f\u06cc\u062f"),z(),j()}}),e("Customers-Club","CampaignsList.Footer",{data:d,loading:C,reload:j,...S})]})})}},97324:(e,o,t)=>{t.d(o,{A:()=>S});var r=t(34535),n=t(24010),i=t(81e3),a=t(26240),s=t(79285),l=t(24836),c=t(35316),d=t(68903),h=t(88911),p=t(8302),u=t(73216),m=t(30370),g=t(54049),b=t(30298),x=t(17392),A=t(85865),v=(t(65043),t(70579));const C=(0,r.Ay)(x.A)((({theme:e})=>({display:"flex",flexDirection:"column",minWidth:94.5}))),f=(0,r.Ay)("span")((({theme:e})=>({display:"inline-block"}))),j=(0,r.Ay)(A.A)((({theme:e})=>({...e.typography.button,display:"inline-block"}))),w=({label:e,labelTypographyProps:o={},children:t,...r})=>(0,v.jsxs)(C,{...r,children:[(0,v.jsx)(f,{children:t}),e&&(0,v.jsx)(j,{...o,children:e})]});var y=t(99275);const k=(0,r.Ay)(n.A)((({theme:e})=>({position:"fixed",bottom:`calc(${e.spacing(2)} + 48px)`,left:e.spacing(2),zIndex:100}))),P=(0,r.Ay)(i.A)((({theme:e})=>({}))),z=(0,r.Ay)("span")((({theme:e})=>({border:"1px solid currentColor",borderRadius:"50%",padding:e.spacing(.75),display:"flex",alignItems:"center",justifyContent:"center"}))),S=({actions:e=[],ResponsiveActionComponent:o=k,responsiveActionProps:t={},ResponsiveActionIcon:r,showResponsiveOnDesktop:n=!1})=>{var i,x;const A=(0,a.A)(),C=(0,s.A)(A.breakpoints.down("sm")),f=(0,u.Zp)(),j="actions",{hasSegment:S,addSegment:R,removeSegment:I}=(0,b.A)(),F=(0,g.A)(),D=({children:o})=>e.length>1?(0,v.jsx)(v.Fragment,{children:o}):(0,v.jsx)(l.A,{direction:"up",in:!F,mountOnEnter:!0,unmountOnExit:!0,children:o});return n||C?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(D,{children:(0,v.jsx)(o,{onClick:e.length>1?()=>f(R(j)):null===(i=e[0])||void 0===i?void 0:i.onClick,...t,children:e.length>1?r:null===(x=e[0])||void 0===x?void 0:x.icon})}),e.length>0&&(0,v.jsx)(y.A,{dialogProps:{fullWidth:!0,maxWidth:"xs"},open:S(j),onClose:()=>f(I(j),{replace:!0}),children:(0,v.jsx)(c.A,{children:(0,v.jsx)(d.Ay,{container:!0,columns:3,children:e.map(((e,o)=>(0,v.jsx)(m.UX,{authorize:e.authorize,children:(0,v.jsx)(d.Ay,{item:!0,xs:1,alignItems:"center",justifyContent:"center",children:(0,v.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,v.jsx)(w,{label:e.title,onClick:e.onClick,size:"large",color:"inherit",labelTypographyProps:{sx:{mt:1}},children:(0,v.jsx)(z,{children:e.icon})})})})},o)))})})})]}):(0,v.jsx)(P,{children:(0,v.jsx)(h.A,{direction:C?"row-reverse":"row",spacing:1,children:e.map(((e,o)=>(0,v.jsx)(m.UX,{authorize:e.authorize,children:(0,v.jsx)(p.A,{variant:"transparent",disableElevation:!0,startIcon:e.icon,onClick:e.onClick,...e.buttonProps,children:e.title})},o)))})})}}}]);
//# sourceMappingURL=5912.e37f02d0.chunk.js.map